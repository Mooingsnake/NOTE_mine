## 前言
介绍纯新手如何快速学习gameframework。 友情提醒，gf有一丢丢的时效性，如果我的内容和搜索到的不符合，那可能是gf更新了，可能是我菜，因为我确实菜。

gameframework有一个自己的demo，叫做StarForce，可以在作者自己的github上查看。

快速上手和安装不讲，默认知道那些组件。

## 0.运行StarForce
打开project，筛选成scene，不是main也不是menu，是launch：
![image](https://user-images.githubusercontent.com/47411365/142642531-30edb22b-1b28-44b1-94d8-bf83bdc1493b.png)


另外整个框架要求launch的那个scene挂着一个已经做好的prefab：gameframework

![image](https://user-images.githubusercontent.com/47411365/142642441-581b5373-da1c-4dda-88a1-b6b62c390c61.png)

你可以自己增加组件，对于模块化每一类功能有好处。

## 1.流程速览
![image](https://user-images.githubusercontent.com/47411365/142641882-86be0c49-1f59-478f-984b-bd42f408a9d6.png)

流程须知：Procedure，实际上继承自一个自动机，这个自动机会在最开始的时候初始化所有的《状态》，也就是每一个procedure类

根据什么初始化的？这个需要你在编辑器界面手动设置，不然的话过会跳转容易空值

![image](https://user-images.githubusercontent.com/47411365/142643137-87351971-a1b9-4bba-8325-ec9aef4713a7.png)

![image](https://user-images.githubusercontent.com/47411365/142643323-df3d6647-8b65-4f73-9bc1-22a4e5f88446.png)

我们都知道自动机可以存成一个map，或者矩阵之类的，但是这里单纯用代码手动转：

![image](https://user-images.githubusercontent.com/47411365/142643535-0d311efc-39e3-427b-80a8-6e4395ae6d29.png)

而ProcedureOwner，就是这个自动机：

![image](https://user-images.githubusercontent.com/47411365/142643596-0a319b15-c110-4bea-9c26-4fa61f3d0672.png)


## 2.资源加载

这个框架的资源加载属于异步加载，这意味着：

1.这个资源加载函数运行了就像挂在电脑后台的迅雷下载器一样不靠谱（但是挺快的，所以不是百度云），你并不能保证调用了loadData以后在下一帧里面就能拿到数据，规范的做应该在每个Procedure类里面监控加载的进度。

比方说preload里面是这样的：

![image](https://user-images.githubusercontent.com/47411365/142648177-52c633c1-c1d2-48ca-b4fb-40edfd90b4ea.png)

OnEnter里面Clear

OnUpdate里面检查：
```
        protected override void OnUpdate(ProcedureOwner procedureOwner, float elapseSeconds, float realElapseSeconds)
        {
            base.OnUpdate(procedureOwner, elapseSeconds, realElapseSeconds);
            foreach (KeyValuePair<string, bool> loadedFlag in m_LoadedFlag)
            {
                if (!loadedFlag.Value)
                {
                    return;
                }
            }

            procedureOwner.SetData<VarInt32>("NextSceneId", GameEntry.Config.GetInt("Scene.Menu"));
            ChangeState<ProcedureChangeScene>(procedureOwner);
        }
```

加载就Add
```
        private void LoadDataTable(string dataTableName)
        {
            string dataTableAssetName = AssetUtility.GetDataTableAsset(dataTableName, false);
            m_LoadedFlag.Add(dataTableAssetName, false);
            GameEntry.DataTable.LoadDataTable(dataTableName, dataTableAssetName, this);
        }
```
加载成功就设置True
```
        private void OnLoadConfigSuccess(object sender, GameEventArgs e)
        {
            LoadConfigSuccessEventArgs ne = (LoadConfigSuccessEventArgs)e;
            if (ne.UserData != this)
            {
                return;
            }

            m_LoadedFlag[ne.ConfigAssetName] = true;
            Log.Info("Load config '{0}' OK.", ne.ConfigAssetName);
        }
```

2.关于怎么使用.txt和.byte数据
```
GameEntry.DataTable.LoadDataTable(dataTableName, dataTableAssetName, this);
```
你会发现LoadDataTable是在这个文件里面：

![image](https://user-images.githubusercontent.com/47411365/142648694-d2b830c0-8a4d-4fb2-adf0-d88518987550.png)

这是C#的静态拓展，自己搜一下就知道了。

## 2.1 加载模式

你在Resource这个组件里面只能看到这些选项，而这些选项都希望你使用AB包：

![image](https://user-images.githubusercontent.com/47411365/142649367-6bf35053-eead-4011-9676-ee1ef2dd7f82.png)

编辑模式在这里，这个模式是天生的，你什么也不用改就这样了：

![image](https://user-images.githubusercontent.com/47411365/142650685-1f796620-c561-452b-ad9f-bb876a6bc5b5.png)

## 3.事件和订阅

不用搞的太清楚，反正订阅=关注，订阅的事件官方基本都有给你注册好了，他们的流程里面会自己找到合理的时间一个个让这些事件发生，我们要做的就是写这些事件发生的具体函数。

也就是：当发生的时候使用xxxx（你想实现的功能）！效果拔群！

下面就是ProcedurePreload 在load数据表的时候发生的事情。

![image](https://user-images.githubusercontent.com/47411365/142645236-814c56b7-4744-442a-869e-c05534e809ee.png)

![image](https://user-images.githubusercontent.com/47411365/142645503-30bdba65-e6c5-4adc-a09f-1a2050e9ffd2.png)

![image](https://user-images.githubusercontent.com/47411365/142645153-3448735f-f949-4821-847f-b97dccd285d9.png)

## 4.想看源码的时候

技巧上推荐直接在作者的github里面自己搜索关键词，单纯在自己的项目里面或者StarForce的项目里面只能看到接口看不到具体的实现。


